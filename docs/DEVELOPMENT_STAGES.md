# Этапы разработки, коммиты и план screencast

Документ помогает:
- разбить работу на понятные этапы (и уложиться примерно в 90 минут);
- сделать “красивую” историю коммитов;
- подготовить содержательное screencast-видео, которое закрывает критерии оценки.

## Конвенции

### 1) Стиль коммитов (Conventional Commits)

Рекомендуемый формат:
- `chore: ...` — настройка, инфраструктура
- `feat: ...` — новая функциональность
- `fix: ...` — исправления
- `test: ...` — тесты
- `docs: ...` — документация

Почему это важно: проверяющему проще увидеть прогресс и этапность.

### 2) Критерий “этап завершён”

Этап считается завершённым, если:
- UI не ломается на маленьком экране (есть скролл/адаптив);
- логика (подписка/locked) работает “как в ТЗ”;
- есть минимум ручной QA на 2 размерах экрана;
- важные бизнес-правила вынесены в `domain`/`services` (а не размазаны по экранам).

---

## Этап 0 — Инициализация проекта (10–15 мин)

**Задачи**
- Создать Expo проект с TypeScript.
- Подключить React Navigation (stack).
- Подключить NativeWind (или другую UI-библиотеку, если выбран иной стек).
- Создать базовые экраны-заглушки: Paywall, Meditations.

**Acceptance criteria**
- Приложение запускается на Ubuntu в Android Emulator / Expo Go.
- Есть навигация между двумя экранами.

**Коммиты**
- `chore: init expo project (typescript)`
- `chore: add navigation`
- `chore: add nativewind and base styling`
- `feat: add paywall and meditations screen scaffolds`

---

## Этап 1 — Базовый layout + SafeArea (10 мин)

**Задачи**
- Добавить `components/ui/Screen.tsx` (SafeArea + стандартные паддинги + maxWidth контейнера).
- Добавить дизайн-токены в `theme/*` (spacing/typography/colors).

**Acceptance criteria**
- На обоих экранах контент не перекрывается статусбаром.
- Отступы на экранах выглядят одинаково.

**Коммит**
- `feat: add Screen wrapper with safe area and theme tokens`

---

## Этап 2 — Paywall UI (20–25 мин)

**Задачи**
- “Премиальный” фон (градиент), заголовок, описание.
- Список преимуществ Premium.
- Блок выбора тарифов: Monthly / Yearly (годовой выделен как “выгодный”).
- CTA “Try free”.
- Сделать Paywall скроллируемым (важно для маленьких экранов).

**Acceptance criteria**
- На маленьком экране весь Paywall доступен через скролл.
- Выбор тарифа визуально понятен.
- CTA всегда достижим (не “уезжает” под экран).

**Коммиты**
- `feat: build paywall layout and premium styling`
- `fix: make paywall scrollable on small screens`

---

## Этап 3 — Мок подписки + персистентность (10–15 мин)

**Задачи**
- Ввести `services/subscription/*`:
  - `buyPremium()` (симуляция успеха + задержка)
  - `load()`/`save()` для `isSubscribed`
- Ввести `SubscriptionProvider`:
  - грузит флаг на старте
  - даёт `isSubscribed` и `buyPremium`
- CTA на Paywall вызывает `buyPremium()` и переводит на Meditations.

**Acceptance criteria**
- После “покупки” флаг сохраняется и не сбрасывается при перезапуске.

**Коммиты**
- `feat: add subscription service (mock) with persistence`
- `feat: wire paywall CTA to subscription state`

---

## Этап 4 — Meditations список + locked логика (15–20 мин)

**Задачи**
- Добавить список медитаций (`features/meditations/data/meditations.ts`).
- Добавить `MeditationCard` (картинка, длительность, заголовок).
- Вынести правило доступа в `features/meditations/domain/access.ts`.
- Визуально выделить locked карточки (оверлей/замок/disabled стиль).
- Если пользователь нажал locked карточку при `isSubscribed=false` → навигация на Paywall.

**Acceptance criteria**
- Часть карточек locked при `isSubscribed=false`.
- При покупке все карточки доступны.

**Коммит**
- `feat: add meditations list with locked premium content gating`

---

## Этап 5 — AI “Настрой дня” (10–15 мин)

**Задачи**
- UI: 3 варианта настроения + кнопка Generate + блок результата.
- `services/ai/*`:
  - `prompts.ts` (шаблон промпта)
  - `ai.service.ts` (mock с задержкой, fallback)
- UX: loading, disable кнопки на время генерации, скролл результата.

**Acceptance criteria**
- Нельзя сгенерировать без выбора настроения (валидация/подсказка).
- Результат короткий и отображается корректно на маленьком экране.

**Коммит**
- `feat: add mood-based AI generator (mock provider)`

---

## Этап 6 — Полировка адаптива и UX (10–20 мин)

**Задачи**
- Проверить UI на маленьком и большом экране.
- Исправить:
  - переполнение по высоте (ScrollView),
  - слишком большие отступы,
  - “пустоту” на больших экранах (maxWidth/центрирование),
  - длинные тексты (перенос/скролл).

**Acceptance criteria**
- Paywall и AI результат корректно отображаются на “маленьком” профиле.
- На “большом” профиле UI не расползается и выглядит аккуратно.

**Коммит**
- `fix: improve responsive layout for small and large screens`

---

## Этап 7 — Тесты (10–20 мин)

**Задачи**
- Unit:
  - access rules
  - prompt builder
- Integration:
  - paywall → buy → meditations
  - locked tap → paywall

**Acceptance criteria**
- Тесты воспроизводимы локально, без сети.
- Покрыты критические бизнес-правила и флоу.

**Коммиты**
- `test: add unit tests for access rules and prompt builder`
- `test: add navigation gating integration tests`

Подробно: `docs/TEST_STRATEGY.md`.

---

## Этап 8 — Документация и материалы для сдачи (10–20 мин)

**Задачи**
- README:
  - описание проекта, запуск на Ubuntu
  - ссылки на видео/скрины
  - ответ на контрольный вопрос
- docs:
  - архитектура
  - AI промпты
  - QA чеклист
- Скриншоты/видео:
  - проход Paywall → Meditations → AI генерация

**Acceptance criteria**
- Проверяющий открывает README и сразу видит:
  - что сделано,
  - как запустить,
  - как проверять качество.

**Коммит**
- `docs: add architecture, QA checklist, and delivery notes`

---

## План screencast (7–12 минут)

Сценарий (рекомендуемый):

1) 20–30 сек: что за приложение, какие 3 экрана/фичи.
2) 1–2 мин: Paywall — показать “дорогой” дизайн + выбор планов + CTA.
3) 1–2 мин: логика подписки — где `isSubscribed`, как сохраняется, где проверяется.
4) 1–2 мин: Meditations — locked карточки + переход на paywall.
5) 1–2 мин: AI “Настрой дня” — выбор настроения → генерация (мок/LLM).
6) 2–3 мин (важнейшее под критерии): адаптив и исправления:
   - открыть маленький профиль → показать, что что‑то “поехало” (или объяснить, что проверяете),
   - показать, как через AI-редактор формулируете задачу “исправь SafeArea/Scroll/CTA”,
   - применить правку → показать результат на маленьком и большом профиле.

### Примеры промптов для AI-редактора (дизайн/верстка)

Paywall:
- “Собери paywall экран в стиле premium meditation: градиентный фон, крупный заголовок, список преимуществ, карточки планов Monthly/Yearly, выдели Yearly как выгодный. Учти SafeArea и маленькие экраны: экран должен скроллиться и CTA всегда должен быть доступен.”

Исправление адаптива:
- “На маленьком экране CTA уходит вниз и недоступен. Сделай layout скроллируемым, сохрани отступы SafeArea, а CTA оставь внизу контента. Проверь, что на большом экране контент не расползается — добавь maxWidth и центрирование.”

Locked логика:
- “Если isSubscribed=false, premium карточки должны быть серыми и показывать замок. Тап по ним должен вести на Paywall. Логику locked вынеси в отдельную функцию (domain), чтобы не дублировать условия в UI.”

---

## Чеклист сдачи

- [ ] Есть screencast 7–12 минут (код + эмулятор/телефон)
- [ ] GitHub репозиторий с историей коммитов по этапам
- [ ] README с запуском на Ubuntu, архитектурой, тестами, ответом на контрольный вопрос
- [ ] Скриншоты/демо-видео итогового флоу

